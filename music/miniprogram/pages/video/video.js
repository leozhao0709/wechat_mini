"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var httpUtils_1 = require("../../utils/httpUtils");
Page({
    data: {
        groupList: [],
        activeGroupId: 0,
        videoList: [],
        playingVideoContext: null,
        playingVideoId: '',
    },
    onLoad: function (options) { },
    loadNavList: function () {
        var _this = this;
        return httpUtils_1.default
            .get('/video/group/list')
            .then(function (res) { return res.data; })
            .then(function (res) {
            var activeItemId = res.data[0].id;
            _this.setData({
                groupList: res.data.slice(0, 14),
                activeGroupId: activeItemId,
            });
            return activeItemId;
        });
    },
    loadVideoList: function (groupId) {
        var _this = this;
        return httpUtils_1.default
            .get('/video/group', { id: groupId })
            .then(function (res) { return res.data; })
            .then(function (res) {
            if (res.code === 301) {
                wx.navigateTo({ url: '/pages/login/login' });
            }
            if (res.code === 200) {
                var videoList = res.datas.map(function (data) { return data.data; });
                _this.setData({
                    videoList: videoList,
                });
            }
        });
    },
    onTapNavItem: function (event) {
        var activeItemId = event.currentTarget.dataset.itemId;
        this.setData({
            activeGroupId: activeItemId,
            videoList: [],
        });
        wx.showLoading({
            title: 'loading...',
            mask: true,
        });
        this.loadVideoList(activeItemId).then(function () { return wx.hideLoading(); });
    },
    onPlayVideo: function (event) {
        var vid = event.currentTarget.id;
        if (this.data.playingVideoId === vid) {
            return;
        }
        if (this.data.playingVideoContext) {
            this.data.playingVideoContext.stop();
        }
        this.setData({
            playingVideoId: vid,
            playingVideoContext: wx.createVideoContext(vid),
        });
    },
    onReady: function () { },
    onShow: function () {
        var _this = this;
        this.loadNavList().then(function (activeGroupId) { return _this.loadVideoList(activeGroupId); });
    },
    onHide: function () { },
    onUnload: function () { },
    onPullDownRefresh: function () { },
    onReachBottom: function () { },
    onShareAppMessage: function () { },
    onPageScroll: function () { },
    onTabItemTap: function (item) { },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlkZW8uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ2aWRlby50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1EQUE4QztBQUU5QyxJQUFJLENBQUM7SUFDSCxJQUFJLEVBQUU7UUFDSixTQUFTLEVBQUUsRUFBdUI7UUFDbEMsYUFBYSxFQUFFLENBQUM7UUFDaEIsU0FBUyxFQUFFLEVBQXlCO1FBQ3BDLG1CQUFtQixFQUFFLElBQTZDO1FBQ2xFLGNBQWMsRUFBRSxFQUFFO0tBQ25CO0lBRUQsTUFBTSxFQUFFLFVBQVUsT0FBTyxJQUFHLENBQUM7SUFFN0IsV0FBVyxFQUFYO1FBQUEsaUJBWUM7UUFYQyxPQUFPLG1CQUFTO2FBQ2IsR0FBRyxDQUE4QixtQkFBbUIsQ0FBQzthQUNyRCxJQUFJLENBQUMsVUFBQyxHQUFHLElBQUssT0FBQSxHQUFHLENBQUMsSUFBSSxFQUFSLENBQVEsQ0FBQzthQUN2QixJQUFJLENBQUMsVUFBQyxHQUFHO1lBQ1IsSUFBTSxZQUFZLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDcEMsS0FBSSxDQUFDLE9BQU8sQ0FBQztnQkFDWCxTQUFTLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQztnQkFDaEMsYUFBYSxFQUFFLFlBQVk7YUFDNUIsQ0FBQyxDQUFDO1lBQ0gsT0FBTyxZQUFZLENBQUM7UUFDdEIsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQsYUFBYSxFQUFiLFVBQWMsT0FBZTtRQUE3QixpQkFnQkM7UUFmQyxPQUFPLG1CQUFTO2FBQ2IsR0FBRyxDQUEyRCxjQUFjLEVBQUUsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLENBQUM7YUFDOUYsSUFBSSxDQUFDLFVBQUMsR0FBRyxJQUFLLE9BQUEsR0FBRyxDQUFDLElBQUksRUFBUixDQUFRLENBQUM7YUFDdkIsSUFBSSxDQUFDLFVBQUMsR0FBRztZQUNSLElBQUksR0FBRyxDQUFDLElBQUksS0FBSyxHQUFHLEVBQUU7Z0JBRXBCLEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxHQUFHLEVBQUUsb0JBQW9CLEVBQUUsQ0FBQyxDQUFDO2FBQzlDO1lBQ0QsSUFBSSxHQUFHLENBQUMsSUFBSSxLQUFLLEdBQUcsRUFBRTtnQkFDcEIsSUFBTSxTQUFTLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsVUFBQyxJQUFJLElBQUssT0FBQSxJQUFJLENBQUMsSUFBSSxFQUFULENBQVMsQ0FBQyxDQUFDO2dCQUNyRCxLQUFJLENBQUMsT0FBTyxDQUFDO29CQUNYLFNBQVMsV0FBQTtpQkFDVixDQUFDLENBQUM7YUFDSjtRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVELFlBQVksRUFBRSxVQUFVLEtBQW1DO1FBQ3pELElBQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztRQUN4RCxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsYUFBYSxFQUFFLFlBQVk7WUFDM0IsU0FBUyxFQUFFLEVBQUU7U0FDZCxDQUFDLENBQUM7UUFDSCxFQUFFLENBQUMsV0FBVyxDQUFDO1lBQ2IsS0FBSyxFQUFFLFlBQVk7WUFDbkIsSUFBSSxFQUFFLElBQUk7U0FDWCxDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFNLE9BQUEsRUFBRSxDQUFDLFdBQVcsRUFBRSxFQUFoQixDQUFnQixDQUFDLENBQUM7SUFDaEUsQ0FBQztJQUVELFdBQVcsRUFBRSxVQUFVLEtBQW1DO1FBQ3hELElBQU0sR0FBRyxHQUFHLEtBQUssQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDO1FBRW5DLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLEtBQUssR0FBRyxFQUFFO1lBQ3BDLE9BQU87U0FDUjtRQUVELElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRTtZQUNqQyxJQUFJLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksRUFBRSxDQUFDO1NBQ3RDO1FBRUQsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNYLGNBQWMsRUFBRSxHQUFHO1lBQ25CLG1CQUFtQixFQUFFLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLENBQUM7U0FDaEQsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELE9BQU8sRUFBRSxjQUFhLENBQUM7SUFDdkIsTUFBTSxFQUFFO1FBQUEsaUJBRVA7UUFEQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsSUFBSSxDQUFDLFVBQUMsYUFBYSxJQUFLLE9BQUEsS0FBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsRUFBakMsQ0FBaUMsQ0FBQyxDQUFDO0lBQ2hGLENBQUM7SUFDRCxNQUFNLEVBQUUsY0FBYSxDQUFDO0lBQ3RCLFFBQVEsRUFBRSxjQUFhLENBQUM7SUFDeEIsaUJBQWlCLEVBQUUsY0FBYSxDQUFDO0lBQ2pDLGFBQWEsRUFBRSxjQUFhLENBQUM7SUFDN0IsaUJBQWlCLEVBQUUsY0FBYSxDQUFDO0lBQ2pDLFlBQVksRUFBRSxjQUFhLENBQUM7SUFFNUIsWUFBWSxFQUFFLFVBQVUsSUFBSSxJQUFHLENBQUM7Q0FDakMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGh0dHBVdGlscyBmcm9tICcuLi8uLi91dGlscy9odHRwVXRpbHMnO1xuLy9QYWdlIE9iamVjdFxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICBncm91cExpc3Q6IFtdIGFzIFZpZGVvUGFnZS5OYXZMaXN0LFxuICAgIGFjdGl2ZUdyb3VwSWQ6IDAsXG4gICAgdmlkZW9MaXN0OiBbXSBhcyBWaWRlb1BhZ2UuVmlkZW9MaXN0LFxuICAgIHBsYXlpbmdWaWRlb0NvbnRleHQ6IG51bGwgYXMgbnVsbCB8IFdlY2hhdE1pbmlwcm9ncmFtLlZpZGVvQ29udGV4dCxcbiAgICBwbGF5aW5nVmlkZW9JZDogJycsXG4gIH0sXG4gIC8vb3B0aW9ucyhPYmplY3QpXG4gIG9uTG9hZDogZnVuY3Rpb24gKG9wdGlvbnMpIHt9LFxuXG4gIGxvYWROYXZMaXN0KCkge1xuICAgIHJldHVybiBodHRwVXRpbHNcbiAgICAgIC5nZXQ8eyBkYXRhOiBWaWRlb1BhZ2UuTmF2TGlzdCB9PignL3ZpZGVvL2dyb3VwL2xpc3QnKVxuICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLmRhdGEpXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZUl0ZW1JZCA9IHJlcy5kYXRhWzBdLmlkO1xuICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgIGdyb3VwTGlzdDogcmVzLmRhdGEuc2xpY2UoMCwgMTQpLFxuICAgICAgICAgIGFjdGl2ZUdyb3VwSWQ6IGFjdGl2ZUl0ZW1JZCxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhY3RpdmVJdGVtSWQ7XG4gICAgICB9KTtcbiAgfSxcblxuICBsb2FkVmlkZW9MaXN0KGdyb3VwSWQ6IG51bWJlcikge1xuICAgIHJldHVybiBodHRwVXRpbHNcbiAgICAgIC5nZXQ8eyBjb2RlOiBudW1iZXI7IGRhdGFzOiB7IGRhdGE6IFZpZGVvUGFnZS5WaWRlb0l0ZW0gfVtdIH0+KCcvdmlkZW8vZ3JvdXAnLCB7IGlkOiBncm91cElkIH0pXG4gICAgICAudGhlbigocmVzKSA9PiByZXMuZGF0YSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcy5jb2RlID09PSAzMDEpIHtcbiAgICAgICAgICAvLyBuZWVkIGxvZ2luXG4gICAgICAgICAgd3gubmF2aWdhdGVUbyh7IHVybDogJy9wYWdlcy9sb2dpbi9sb2dpbicgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHtcbiAgICAgICAgICBjb25zdCB2aWRlb0xpc3QgPSByZXMuZGF0YXMubWFwKChkYXRhKSA9PiBkYXRhLmRhdGEpO1xuICAgICAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgICAgICB2aWRlb0xpc3QsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9LFxuXG4gIG9uVGFwTmF2SXRlbTogZnVuY3Rpb24gKGV2ZW50OiBXZWNoYXRNaW5pcHJvZ3JhbS5Ub3VjaEV2ZW50KSB7XG4gICAgY29uc3QgYWN0aXZlSXRlbUlkID0gZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0Lml0ZW1JZDtcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgYWN0aXZlR3JvdXBJZDogYWN0aXZlSXRlbUlkLFxuICAgICAgdmlkZW9MaXN0OiBbXSxcbiAgICB9KTtcbiAgICB3eC5zaG93TG9hZGluZyh7XG4gICAgICB0aXRsZTogJ2xvYWRpbmcuLi4nLFxuICAgICAgbWFzazogdHJ1ZSxcbiAgICB9KTtcbiAgICB0aGlzLmxvYWRWaWRlb0xpc3QoYWN0aXZlSXRlbUlkKS50aGVuKCgpID0+IHd4LmhpZGVMb2FkaW5nKCkpO1xuICB9LFxuXG4gIG9uUGxheVZpZGVvOiBmdW5jdGlvbiAoZXZlbnQ6IFdlY2hhdE1pbmlwcm9ncmFtLlRvdWNoRXZlbnQpIHtcbiAgICBjb25zdCB2aWQgPSBldmVudC5jdXJyZW50VGFyZ2V0LmlkO1xuXG4gICAgaWYgKHRoaXMuZGF0YS5wbGF5aW5nVmlkZW9JZCA9PT0gdmlkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGF0YS5wbGF5aW5nVmlkZW9Db250ZXh0KSB7XG4gICAgICB0aGlzLmRhdGEucGxheWluZ1ZpZGVvQ29udGV4dC5zdG9wKCk7XG4gICAgfVxuXG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIHBsYXlpbmdWaWRlb0lkOiB2aWQsXG4gICAgICBwbGF5aW5nVmlkZW9Db250ZXh0OiB3eC5jcmVhdGVWaWRlb0NvbnRleHQodmlkKSxcbiAgICB9KTtcbiAgfSxcblxuICBvblJlYWR5OiBmdW5jdGlvbiAoKSB7fSxcbiAgb25TaG93OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5sb2FkTmF2TGlzdCgpLnRoZW4oKGFjdGl2ZUdyb3VwSWQpID0+IHRoaXMubG9hZFZpZGVvTGlzdChhY3RpdmVHcm91cElkKSk7XG4gIH0sXG4gIG9uSGlkZTogZnVuY3Rpb24gKCkge30sXG4gIG9uVW5sb2FkOiBmdW5jdGlvbiAoKSB7fSxcbiAgb25QdWxsRG93blJlZnJlc2g6IGZ1bmN0aW9uICgpIHt9LFxuICBvblJlYWNoQm90dG9tOiBmdW5jdGlvbiAoKSB7fSxcbiAgb25TaGFyZUFwcE1lc3NhZ2U6IGZ1bmN0aW9uICgpIHt9LFxuICBvblBhZ2VTY3JvbGw6IGZ1bmN0aW9uICgpIHt9LFxuICAvL2l0ZW0oaW5kZXgscGFnZVBhdGgsdGV4dClcbiAgb25UYWJJdGVtVGFwOiBmdW5jdGlvbiAoaXRlbSkge30sXG59KTtcbiJdfQ==