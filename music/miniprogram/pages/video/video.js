"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var httpUtils_1 = require("../../utils/httpUtils");
Page({
    data: {
        groupList: [],
        activeGroupId: 0,
        videoList: [],
    },
    onLoad: function (options) { },
    loadNavList: function () {
        var _this = this;
        return httpUtils_1.default
            .get('/video/group/list')
            .then(function (res) { return res.data; })
            .then(function (res) {
            var activeItemId = res.data[0].id;
            _this.setData({
                groupList: res.data.slice(0, 14),
                activeGroupId: activeItemId,
            });
            return activeItemId;
        });
    },
    loadVideoList: function (groupId) {
        var _this = this;
        return httpUtils_1.default
            .get('/video/group', { id: groupId })
            .then(function (res) { return res.data; })
            .then(function (res) {
            if (res.code === 301) {
                wx.navigateTo({ url: '/pages/login/login' });
            }
            if (res.code === 200) {
                var videoList = res.datas.map(function (data) { return data.data; });
                _this.setData({
                    videoList: videoList,
                });
            }
        });
    },
    onTapNavItem: function (event) {
        var activeItemId = event.currentTarget.dataset.itemId;
        this.setData({
            activeGroupId: activeItemId,
            videoList: [],
        });
        wx.showLoading({
            title: 'loading...',
            mask: true,
        });
        this.loadVideoList(activeItemId).then(function () { return wx.hideLoading(); });
    },
    onReady: function () { },
    onShow: function () {
        var _this = this;
        this.loadNavList().then(function (activeGroupId) { return _this.loadVideoList(activeGroupId); });
    },
    onHide: function () { },
    onUnload: function () { },
    onPullDownRefresh: function () { },
    onReachBottom: function () { },
    onShareAppMessage: function () { },
    onPageScroll: function () { },
    onTabItemTap: function (item) { },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlkZW8uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ2aWRlby50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1EQUE4QztBQUU5QyxJQUFJLENBQUM7SUFDSCxJQUFJLEVBQUU7UUFDSixTQUFTLEVBQUUsRUFBdUI7UUFDbEMsYUFBYSxFQUFFLENBQUM7UUFDaEIsU0FBUyxFQUFFLEVBQXlCO0tBQ3JDO0lBRUQsTUFBTSxFQUFFLFVBQVUsT0FBTyxJQUFHLENBQUM7SUFFN0IsV0FBVyxFQUFYO1FBQUEsaUJBWUM7UUFYQyxPQUFPLG1CQUFTO2FBQ2IsR0FBRyxDQUE4QixtQkFBbUIsQ0FBQzthQUNyRCxJQUFJLENBQUMsVUFBQyxHQUFHLElBQUssT0FBQSxHQUFHLENBQUMsSUFBSSxFQUFSLENBQVEsQ0FBQzthQUN2QixJQUFJLENBQUMsVUFBQyxHQUFHO1lBQ1IsSUFBTSxZQUFZLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDcEMsS0FBSSxDQUFDLE9BQU8sQ0FBQztnQkFDWCxTQUFTLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQztnQkFDaEMsYUFBYSxFQUFFLFlBQVk7YUFDNUIsQ0FBQyxDQUFDO1lBQ0gsT0FBTyxZQUFZLENBQUM7UUFDdEIsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQsYUFBYSxFQUFiLFVBQWMsT0FBZTtRQUE3QixpQkFnQkM7UUFmQyxPQUFPLG1CQUFTO2FBQ2IsR0FBRyxDQUEyRCxjQUFjLEVBQUUsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLENBQUM7YUFDOUYsSUFBSSxDQUFDLFVBQUMsR0FBRyxJQUFLLE9BQUEsR0FBRyxDQUFDLElBQUksRUFBUixDQUFRLENBQUM7YUFDdkIsSUFBSSxDQUFDLFVBQUMsR0FBRztZQUNSLElBQUksR0FBRyxDQUFDLElBQUksS0FBSyxHQUFHLEVBQUU7Z0JBRXBCLEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxHQUFHLEVBQUUsb0JBQW9CLEVBQUUsQ0FBQyxDQUFDO2FBQzlDO1lBQ0QsSUFBSSxHQUFHLENBQUMsSUFBSSxLQUFLLEdBQUcsRUFBRTtnQkFDcEIsSUFBTSxTQUFTLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsVUFBQyxJQUFJLElBQUssT0FBQSxJQUFJLENBQUMsSUFBSSxFQUFULENBQVMsQ0FBQyxDQUFDO2dCQUNyRCxLQUFJLENBQUMsT0FBTyxDQUFDO29CQUNYLFNBQVMsV0FBQTtpQkFDVixDQUFDLENBQUM7YUFDSjtRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVELFlBQVksRUFBRSxVQUFVLEtBQW1DO1FBQ3pELElBQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztRQUN4RCxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsYUFBYSxFQUFFLFlBQVk7WUFDM0IsU0FBUyxFQUFFLEVBQUU7U0FDZCxDQUFDLENBQUM7UUFDSCxFQUFFLENBQUMsV0FBVyxDQUFDO1lBQ2IsS0FBSyxFQUFFLFlBQVk7WUFDbkIsSUFBSSxFQUFFLElBQUk7U0FDWCxDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFNLE9BQUEsRUFBRSxDQUFDLFdBQVcsRUFBRSxFQUFoQixDQUFnQixDQUFDLENBQUM7SUFDaEUsQ0FBQztJQUVELE9BQU8sRUFBRSxjQUFhLENBQUM7SUFDdkIsTUFBTSxFQUFFO1FBQUEsaUJBRVA7UUFEQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsSUFBSSxDQUFDLFVBQUMsYUFBYSxJQUFLLE9BQUEsS0FBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsRUFBakMsQ0FBaUMsQ0FBQyxDQUFDO0lBQ2hGLENBQUM7SUFDRCxNQUFNLEVBQUUsY0FBYSxDQUFDO0lBQ3RCLFFBQVEsRUFBRSxjQUFhLENBQUM7SUFDeEIsaUJBQWlCLEVBQUUsY0FBYSxDQUFDO0lBQ2pDLGFBQWEsRUFBRSxjQUFhLENBQUM7SUFDN0IsaUJBQWlCLEVBQUUsY0FBYSxDQUFDO0lBQ2pDLFlBQVksRUFBRSxjQUFhLENBQUM7SUFFNUIsWUFBWSxFQUFFLFVBQVUsSUFBSSxJQUFHLENBQUM7Q0FDakMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGh0dHBVdGlscyBmcm9tICcuLi8uLi91dGlscy9odHRwVXRpbHMnO1xuLy9QYWdlIE9iamVjdFxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICBncm91cExpc3Q6IFtdIGFzIFZpZGVvUGFnZS5OYXZMaXN0LFxuICAgIGFjdGl2ZUdyb3VwSWQ6IDAsXG4gICAgdmlkZW9MaXN0OiBbXSBhcyBWaWRlb1BhZ2UuVmlkZW9MaXN0LFxuICB9LFxuICAvL29wdGlvbnMoT2JqZWN0KVxuICBvbkxvYWQ6IGZ1bmN0aW9uIChvcHRpb25zKSB7fSxcblxuICBsb2FkTmF2TGlzdCgpIHtcbiAgICByZXR1cm4gaHR0cFV0aWxzXG4gICAgICAuZ2V0PHsgZGF0YTogVmlkZW9QYWdlLk5hdkxpc3QgfT4oJy92aWRlby9ncm91cC9saXN0JylcbiAgICAgIC50aGVuKChyZXMpID0+IHJlcy5kYXRhKVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBjb25zdCBhY3RpdmVJdGVtSWQgPSByZXMuZGF0YVswXS5pZDtcbiAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICBncm91cExpc3Q6IHJlcy5kYXRhLnNsaWNlKDAsIDE0KSxcbiAgICAgICAgICBhY3RpdmVHcm91cElkOiBhY3RpdmVJdGVtSWQsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYWN0aXZlSXRlbUlkO1xuICAgICAgfSk7XG4gIH0sXG5cbiAgbG9hZFZpZGVvTGlzdChncm91cElkOiBudW1iZXIpIHtcbiAgICByZXR1cm4gaHR0cFV0aWxzXG4gICAgICAuZ2V0PHsgY29kZTogbnVtYmVyOyBkYXRhczogeyBkYXRhOiBWaWRlb1BhZ2UuVmlkZW9JdGVtIH1bXSB9PignL3ZpZGVvL2dyb3VwJywgeyBpZDogZ3JvdXBJZCB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLmRhdGEpXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMuY29kZSA9PT0gMzAxKSB7XG4gICAgICAgICAgLy8gbmVlZCBsb2dpblxuICAgICAgICAgIHd4Lm5hdmlnYXRlVG8oeyB1cmw6ICcvcGFnZXMvbG9naW4vbG9naW4nIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgY29uc3QgdmlkZW9MaXN0ID0gcmVzLmRhdGFzLm1hcCgoZGF0YSkgPT4gZGF0YS5kYXRhKTtcbiAgICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgICAgdmlkZW9MaXN0LFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfSxcblxuICBvblRhcE5hdkl0ZW06IGZ1bmN0aW9uIChldmVudDogV2VjaGF0TWluaXByb2dyYW0uVG91Y2hFdmVudCkge1xuICAgIGNvbnN0IGFjdGl2ZUl0ZW1JZCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pdGVtSWQ7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGFjdGl2ZUdyb3VwSWQ6IGFjdGl2ZUl0ZW1JZCxcbiAgICAgIHZpZGVvTGlzdDogW10sXG4gICAgfSk7XG4gICAgd3guc2hvd0xvYWRpbmcoe1xuICAgICAgdGl0bGU6ICdsb2FkaW5nLi4uJyxcbiAgICAgIG1hc2s6IHRydWUsXG4gICAgfSk7XG4gICAgdGhpcy5sb2FkVmlkZW9MaXN0KGFjdGl2ZUl0ZW1JZCkudGhlbigoKSA9PiB3eC5oaWRlTG9hZGluZygpKTtcbiAgfSxcblxuICBvblJlYWR5OiBmdW5jdGlvbiAoKSB7fSxcbiAgb25TaG93OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5sb2FkTmF2TGlzdCgpLnRoZW4oKGFjdGl2ZUdyb3VwSWQpID0+IHRoaXMubG9hZFZpZGVvTGlzdChhY3RpdmVHcm91cElkKSk7XG4gIH0sXG4gIG9uSGlkZTogZnVuY3Rpb24gKCkge30sXG4gIG9uVW5sb2FkOiBmdW5jdGlvbiAoKSB7fSxcbiAgb25QdWxsRG93blJlZnJlc2g6IGZ1bmN0aW9uICgpIHt9LFxuICBvblJlYWNoQm90dG9tOiBmdW5jdGlvbiAoKSB7fSxcbiAgb25TaGFyZUFwcE1lc3NhZ2U6IGZ1bmN0aW9uICgpIHt9LFxuICBvblBhZ2VTY3JvbGw6IGZ1bmN0aW9uICgpIHt9LFxuICAvL2l0ZW0oaW5kZXgscGFnZVBhdGgsdGV4dClcbiAgb25UYWJJdGVtVGFwOiBmdW5jdGlvbiAoaXRlbSkge30sXG59KTtcbiJdfQ==